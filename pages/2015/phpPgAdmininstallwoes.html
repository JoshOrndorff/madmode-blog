<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta name="generator" content=
  "HTML Tidy for Linux (vers 25 March 2009), see www.w3.org" />

  <title>phpPgAdmin install woes</title>
  <meta content="text/html; charset=us-ascii" http-equiv=
  "content-type" />
  <style type="text/css">
/*<![CDATA[*/
  ol.lst-kix_pg5ke5a6haqi-1{list-style-type:none}ol.lst-kix_pg5ke5a6haqi-0{list-style-type:none}.lst-kix_pg5ke5a6haqi-2>li{counter-increment:lst-ctn-kix_pg5ke5a6haqi-2}ol.lst-kix_pg5ke5a6haqi-7.start{counter-reset:lst-ctn-kix_pg5ke5a6haqi-7 0}ol.lst-kix_pg5ke5a6haqi-3{list-style-type:none}ol.lst-kix_pg5ke5a6haqi-2{list-style-type:none}.lst-kix_pg5ke5a6haqi-4>li:before{content:"" counter(lst-ctn-kix_pg5ke5a6haqi-4,lower-latin) ". "}.lst-kix_pg5ke5a6haqi-6>li{counter-increment:lst-ctn-kix_pg5ke5a6haqi-6}ol.lst-kix_pg5ke5a6haqi-1.start{counter-reset:lst-ctn-kix_pg5ke5a6haqi-1 0}.lst-kix_ep9kibcyvs3h-3>li:before{content:"\0025cf  "}.lst-kix_pg5ke5a6haqi-7>li{counter-increment:lst-ctn-kix_pg5ke5a6haqi-7}ol.lst-kix_pg5ke5a6haqi-6.start{counter-reset:lst-ctn-kix_pg5ke5a6haqi-6 0}ol.lst-kix_pg5ke5a6haqi-4.start{counter-reset:lst-ctn-kix_pg5ke5a6haqi-4 0}.lst-kix_pg5ke5a6haqi-8>li:before{content:"" counter(lst-ctn-kix_pg5ke5a6haqi-8,lower-roman) ". "}.lst-kix_pg5ke5a6haqi-5>li{counter-increment:lst-ctn-kix_pg5ke5a6haqi-5}.lst-kix_pg5ke5a6haqi-0>li:before{content:"" counter(lst-ctn-kix_pg5ke5a6haqi-0,decimal) ". "}.lst-kix_pg5ke5a6haqi-1>li{counter-increment:lst-ctn-kix_pg5ke5a6haqi-1}ul.lst-kix_ep9kibcyvs3h-8{list-style-type:none}ul.lst-kix_ep9kibcyvs3h-7{list-style-type:none}ul.lst-kix_ep9kibcyvs3h-4{list-style-type:none}ul.lst-kix_ep9kibcyvs3h-3{list-style-type:none}ul.lst-kix_ep9kibcyvs3h-6{list-style-type:none}ul.lst-kix_ep9kibcyvs3h-5{list-style-type:none}ol.lst-kix_pg5ke5a6haqi-8.start{counter-reset:lst-ctn-kix_pg5ke5a6haqi-8 0}.lst-kix_ep9kibcyvs3h-5>li:before{content:"\0025a0  "}ol.lst-kix_pg5ke5a6haqi-0.start{counter-reset:lst-ctn-kix_pg5ke5a6haqi-0 0}ol.lst-kix_pg5ke5a6haqi-2.start{counter-reset:lst-ctn-kix_pg5ke5a6haqi-2 0}.lst-kix_pg5ke5a6haqi-5>li:before{content:"" counter(lst-ctn-kix_pg5ke5a6haqi-5,lower-roman) ". "}.lst-kix_pg5ke5a6haqi-2>li:before{content:"" counter(lst-ctn-kix_pg5ke5a6haqi-2,lower-roman) ". "}.lst-kix_pg5ke5a6haqi-8>li{counter-increment:lst-ctn-kix_pg5ke5a6haqi-8}ol.lst-kix_pg5ke5a6haqi-8{list-style-type:none}ol.lst-kix_pg5ke5a6haqi-6{list-style-type:none}ol.lst-kix_pg5ke5a6haqi-7{list-style-type:none}ol.lst-kix_pg5ke5a6haqi-4{list-style-type:none}ol.lst-kix_pg5ke5a6haqi-5{list-style-type:none}.lst-kix_ep9kibcyvs3h-4>li:before{content:"\0025cb  "}.lst-kix_ep9kibcyvs3h-1>li:before{content:"\0025cb  "}.lst-kix_ep9kibcyvs3h-6>li:before{content:"\0025cf  "}ul.lst-kix_ep9kibcyvs3h-2{list-style-type:none}ul.lst-kix_ep9kibcyvs3h-1{list-style-type:none}ul.lst-kix_ep9kibcyvs3h-0{list-style-type:none}ol.lst-kix_pg5ke5a6haqi-5.start{counter-reset:lst-ctn-kix_pg5ke5a6haqi-5 0}.lst-kix_pg5ke5a6haqi-3>li{counter-increment:lst-ctn-kix_pg5ke5a6haqi-3}ol.lst-kix_pg5ke5a6haqi-3.start{counter-reset:lst-ctn-kix_pg5ke5a6haqi-3 0}.lst-kix_pg5ke5a6haqi-3>li:before{content:"" counter(lst-ctn-kix_pg5ke5a6haqi-3,decimal) ". "}.lst-kix_pg5ke5a6haqi-7>li:before{content:"" counter(lst-ctn-kix_pg5ke5a6haqi-7,lower-latin) ". "}.lst-kix_ep9kibcyvs3h-7>li:before{content:"\0025cb  "}.lst-kix_pg5ke5a6haqi-4>li{counter-increment:lst-ctn-kix_pg5ke5a6haqi-4}.lst-kix_ep9kibcyvs3h-2>li:before{content:"\0025a0  "}.lst-kix_ep9kibcyvs3h-0>li:before{content:"\0025cf  "}.lst-kix_pg5ke5a6haqi-0>li{counter-increment:lst-ctn-kix_pg5ke5a6haqi-0}.lst-kix_ep9kibcyvs3h-8>li:before{content:"\0025a0  "}.lst-kix_pg5ke5a6haqi-1>li:before{content:"" counter(lst-ctn-kix_pg5ke5a6haqi-1,lower-latin) ". "}.lst-kix_pg5ke5a6haqi-6>li:before{content:"" counter(lst-ctn-kix_pg5ke5a6haqi-6,decimal) ". "}ol{margin:0;padding:0}.c0{widows:2;orphans:2;height:11pt;direction:ltr}.c1{widows:2;orphans:2;direction:ltr}.c10{max-width:468pt;background-color:#ffffff;padding:72pt 72pt 72pt 72pt}.c4{margin:0;padding:0}.c6{color:inherit;text-decoration:inherit}.c5{color:#1155cc;text-decoration:underline}.c3{padding-left:0pt;margin-left:72pt}.c9{font-style:italic}.c8{margin-left:72pt}.c7{margin-left:36pt}.c2{font-weight:bold}.title{widows:2;padding-top:24pt;line-height:1.15;orphans:2;text-align:left;color:#000000;font-size:36pt;font-family:"Arial";font-weight:bold;padding-bottom:6pt;page-break-after:avoid}.subtitle{widows:2;padding-top:18pt;line-height:1.15;orphans:2;text-align:left;color:#666666;font-style:italic;font-size:24pt;font-family:"Georgia";padding-bottom:4pt;page-break-after:avoid}li{color:#000000;font-size:11pt;font-family:"Arial"}p{color:#000000;font-size:11pt;margin:0;font-family:"Arial"}h1{widows:2;padding-top:24pt;line-height:1.15;orphans:2;text-align:left;color:#000000;font-size:18pt;font-family:"Arial";font-weight:bold;padding-bottom:6pt;page-break-after:avoid}h2{widows:2;padding-top:18pt;line-height:1.15;orphans:2;text-align:left;color:#000000;font-size:14pt;font-family:"Arial";font-weight:bold;padding-bottom:4pt;page-break-after:avoid}h3{widows:2;padding-top:14pt;line-height:1.15;orphans:2;text-align:left;color:#666666;font-size:12pt;font-family:"Arial";font-weight:bold;padding-bottom:4pt;page-break-after:avoid}h4{widows:2;padding-top:12pt;line-height:1.15;orphans:2;text-align:left;color:#666666;font-style:italic;font-size:11pt;font-family:"Arial";padding-bottom:2pt;page-break-after:avoid}h5{widows:2;padding-top:11pt;line-height:1.15;orphans:2;text-align:left;color:#666666;font-size:10pt;font-family:"Arial";font-weight:bold;padding-bottom:2pt;page-break-after:avoid}h6{widows:2;padding-top:10pt;line-height:1.15;orphans:2;text-align:left;color:#666666;font-style:italic;font-size:10pt;font-family:"Arial";padding-bottom:2pt;page-break-after:avoid}
  /*]]>*/
  </style>
</head>

<body class="c10">
  <p class="c1 c7"><span>@dckc 12:42 AM: finally! after 3 hours,
  got phpPgAdmin working. I want to like postgres over mysql, but
  the initial experience is dreadful.</span></p>

  <p class="c1 c8"><span>@robtreat2 8:09PM: @dckc I (and some
  others in the community) would be interested in a more detailed
  writeup if you were willing.</span></p>

  <p class="c0"></p>

  <p class="c1"><span>goal: give peers in a multi-site research
  project access to postgres database underneath a jboss app
  running on CentOS on AWS.</span></p>

  <p class="c0"></p>

  <p class="c1"><span>We&#8217;ve been using ssh and public keys,
  but creating those accounts is tedious. We&#8217;d like to
  delegate to Jenkins, but we don&#8217;t give jenkins blanket root
  access. I realized that something like phpMyAdmin would obviate
  the need for unix accounts altogether.</span></p>

  <p class="c0"></p>

  <p class="c1"><span>Is there such a thing for postgres?
  yes:</span> <span class="c5"><a class="c6" href=
  "http://www.google.com/url?q=http%3A%2F%2Fphppgadmin.sourceforge.net%2Fdoku.php&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHivj_YsdiU6lPeNoJkzMue7H6jTA">
  phpMyAdmin</a></span></p>

  <p class="c0"></p>

  <p class="c1"><span>I downloaded it and checked the</span>
  <span class="c5"><a class="c6" href=
  "https://www.google.com/url?q=https%3A%2F%2Fraw.githubusercontent.com%2Fphppgadmin%2Fphppgadmin%2Fmaster%2FINSTALL&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHrgWD4q8-b0fQ1UbxNRPYor5SGAw">
  INSTALL</a></span><span>&#160;doc:</span></p>

  <ol class="c4 lst-kix_pg5ke5a6haqi-0 start" start="1">
    <li class="c1 c3"><span>Unpack your download ...</span></li>

    <li class="c1 c3"><span>Configure phpPgAdmin - edit
    phpPgAdmin/conf/config.inc.php ...</span></li>

    <li class="c1 c3"><span>Ensure the statistics collector is
    enabled in PostgreSQL. phpPgAdmin will display table, index
    performance, and usage statistics if you have enabled the
    PostgreSQL statistics collector. While this is normally enabled
    by default, ...</span></li>

    <li class="c1 c3"><span>Browse to the phpPgAdmin installation
    using a web browser.</span></li>

    <li class="c1 c3"><span>IMPORTANT - SECURITY<br />
    PostgreSQL by default does not require you to use a password to
    log in. We STRONGLY recommend that you enable md5 passwords for
    local connections in your pg_hba.conf, and set a password for
    the default superuser account.<br />
    <br />
    Due to the large number of phpPgAdmin installations that have
    not set passwords on local connections, there is now a
    configuration file option called 'extra_login_security', which
    is TRUE by default. &#160;While this option is enabled, you
    will be unable to log in to phpPgAdmin as the 'root',
    'administrator', 'pgsql' or 'postgres' users and empty
    passwords will not work.<br />
    <br />
    Once you are certain you have properly secured your database
    server, you can then disable 'extra_login_security' so that you
    can log in as your database administrator using the
    administrator password.</span></li>
  </ol>

  <p class="c0"></p>

  <p class="c1"><span>I don&#8217;t know why step 2 is there. The
  defaults look OK as far as I can tell, so I&#8217;m already not
  sure I&#8217;m doing it right.</span> <span class="c9">If the
  defaults are OK in typical cases, move step 2 to an
  troubleshooting FAQ section later. Likewise step 3, since (a) the
  statistics collector is on by default, and (b) statistics
  doesn&#8217;t seem like a critical &#8220;getting started&#8221;
  feature.</span></p>

  <p class="c0"></p>

  <p class="c1"><span>The fact that the security step comes *after*
  the service is available on the net threw me. I immediately tried
  to figure out what was going on there.</span></p>

  <p class="c0"></p>

  <p class="c1"><span>The reference to &#8220;your
  pg_hba.conf&#8221; was frustrating. I tried to find it with
  locate. No joy. From</span> <span class="c2">rpm -qa | grep
  postgres</span><span>&#160;I recall the main package is</span>
  <span class="c2">postgresql91</span><span>. But</span>
  <span class="c2">rpm -ql postgresql91|grep
  pg_hba</span><span>&#160;turns up empty. I get as far as</span>
  <span class="c2">pg_config
  --sysconfdir</span><span>&#160;says</span> <span class=
  "c2">/etc/sysconfig/pgsql</span><span>&#160;but nope; empty
  too.</span></p>

  <p class="c0"></p>

  <p class="c1"><span>Some relevant-looking docs were easy enough
  to find with a quick web search:</span> <span class=
  "c5"><a class="c6" href=
  "http://www.google.com/url?q=http%3A%2F%2Fwww.postgresql.org%2Fdocs%2F9.1%2Fstatic%2Fauth-pg-hba-conf.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNG5iGA-ZUXb3wgT-Tmy7wjgmQ_Uwg">
  19.1. The pg_hba.conf File</a></span><span>&#160;says:</span></p>

  <p class="c0"></p>

  <p class="c1 c7"><span>A default pg_hba.conf file is installed
  when the data directory is initialized by initdb.</span></p>

  <p class="c0"></p>

  <p class="c1"><span>&#160;Ah&#8230; initdb&#8230; that seems
  familiar. So I pore over notes from setting up the database, and
  I find it: in /var/lib/pgsql/9.1/data/pg_hba.conf. A google
  search for that path turns up 5,840 results, but it&#8217;s not
  there in section 19.1 of the official documentation, nor do I win
  if I follow the link to</span> <span class="c5"><a class="c6"
  href=
  "http://www.google.com/url?q=http%3A%2F%2Fwww.postgresql.org%2Fdocs%2F9.1%2Fstatic%2Fruntime-config-file-locations.html%23GUC-HBA-FILE&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGZaeGWz-b9qism4gYb_dmZvE8YJQ">
  18.2. File Locations</a></span><span>. Before you tell me
  &#8220;It is possible to place the authentication configuration
  file elsewhere &#8230;&#8221; how about you tell me, in concrete,
  literal terms, where it typically is?!?!?!?</span></p>

  <p class="c0"></p>

  <p class="c1"><span>Now that I found it, I don&#8217;t understand
  what exactly I&#8217;m supposed to change. &#8220;We STRONGLY
  recommend that you enable md5 passwords for local connections in
  your pg_hba.conf, and set a password for the default superuser
  account.&#8221; But not so strongly as to spell out how to do it
  nor cite documentation on how to do it. More on that
  below.</span></p>

  <p class="c0"></p>

  <p class="c1"><span>The current configuration seems fail-safe,
  though, so I go ahead with step 4 and try to browse.
  Bzzzt:</span></p>

  <p class="c1 c7"><span>Your PHP installation does not support
  PostgreSQL. You need to recompile PHP using the --with-pgsql
  configure option.</span></p>

  <p class="c0"></p>

  <p class="c1"><span>Then I vaguely remember php&#8217;s mysql
  support is packaged separately, so I got hunting, and surprise!
  CentOS actually supports phpPgAdmin itself:</span></p>

  <p class="c0"></p>

  <p class="c1"><span>$ yum search php | grep -i postgres<br />
  php-pear-MDB2-Driver-pgsql.noarch : PostgreSQL MDB2 driver<br />
  php-pgsql.x86_64 : A PostgreSQL database module for PHP<br />
  phpPgAdmin.noarch : Web-based PostgreSQL
  administration</span></p>

  <p class="c0"></p>

  <p class="c1"><span>So&#8230;</span></p>

  <p class="c0"></p>

  <p class="c1"><span>$ sudo yum install phpPgAdmin<br />
  <br />
  Installed:<br />
  &#160;phpPgAdmin.noarch 0:5.1-1.rhel6 &#160; &#160; &#160; &#160;
  &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;
  &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;
  &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;
  &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;
  &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;
  &#160;<br />
  <br />
  Dependency Installed:<br />
  &#160;php-pdo.x86_64 0:5.3.3-40.el6_6 &#160; &#160; &#160; &#160;
  &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;
  &#160; &#160; &#160; php-pgsql.x86_64
  0:5.3.3-40.el6_<br /></span></p>

  <p class="c1"><span>and try to browse. No joy: some sort of HTTP
  forbidden error.</span></p>

  <p class="c0"></p>

  <p class="c1"><span class="c2">rpm -ql</span><span>&#160;turns
  up</span> <span class=
  "c2">/etc/httpd/conf.d/phpPgAdmin.conf</span><span>, where we
  find &#8220;By default this application is only accessible from
  the local host.&#8221; OK, fair enough. I tweak that apache
  congif file and now I see a phpPgAdmin web page showing one
  server, PostgreSQL. Hmm. I choose it and I get username/password
  prompt. I enter my linux credentials. No joy. &#8220;Login
  failed&#8221;.</span></p>

  <p class="c0"></p>

  <p class="c1"><span>So I go looking for clues in apache log files
  (ssl_error_log, error_log, access_log), linux/centos log files
  (/var/log/messages), and postgres log files
  (/var/lib/pgsql/9.1/data/pg_log/postgresql-Fri.log?). None to be
  had. Is the php.ini config supressing them? Not as far as I can
  tell. So I begin guessing what the problem is.</span></p>

  <p class="c0"></p>

  <p class="c1"><span>Between phpPgAdmin/conf/config.inc.php and
  pg_hba.conf, I must have tried a dozen combinations. In several
  cases, postgres wouldn&#8217;t start at all. In NO CASE were
  there ANY RELEVANT DIAGNOSTICS in ANY LOG FILE that I could find.
  I found logs of SQL syntax errors from ordinary select
  statements, but no connection error logs.</span></p>

  <p class="c0"></p>

  <p class="c1"><span>That phpPgAdmin/conf/config.inc.php file
  says:</span></p>

  <p class="c0"></p>

  <p class="c1"><span>&#160; &#160;
  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// Hostname or IP
  address for server. &#160;Use '' for UNIX domain
  socket.</span></p>

  <p class="c1"><span>&#160; &#160;
  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// use
  'localhost' for TCP/IP connection on this computer</span></p>

  <p class="c1"><span>&#160; &#160;
  &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;$conf['servers'][0]['host']
  = '';</span></p>

  <p class="c0"></p>

  <p class="c1"><span>but what worked was changing the auth-method
  in pg_hba.conf for host 127.0.0.1 to md5.</span></p>

  <p class="c0"></p>

  <p class="c1"><span>Meanwhile, problems setting up passwords
  undermined my confidence in setting up md5 authentication.
  Stackoverflow discussion or something suggested the</span>
  <span class="c2">createuser</span><span>&#160;utility, but it
  kept giving me &#8220;already exists&#8221; errors. I stumbled
  across the</span> <span class="c2">-e</span><span>&#160;flag,
  which spit out the CREATE ROLE &#8230; SQL; I changed that to
  ALTER ROLE &#8230; and it worked.</span></p>

  <p class="c0"></p>

  <p class="c1"><span>Section 19.1 presents an exhaustive
  enumeration of the authentication methods of postgres where I
  would have appreciated successive elaboration: start with the
  simplest, most typical setup, which seems to be peer. Then have
  sections in increasing complexity, where the complexity is
  motivated by related issues; e.g. &#8220;md5 for local
  connections,&#8221; &#8220;passwords with SSL,&#8221; and then
  LDAP, and then rocket-science like kerberos and such. In each
  section, show one complete worked example ending with an actual
  SQL query that worked, even if that worked example doesn&#8217;t
  exercise all of the options. The less typical options can be
  explained reference style without an example.</span></p>

  <p class="c0"></p>
  <hr />

  <p class="c0"></p>

  <p class="c1"><span>Context:</span></p>

  <p class="c0"></p>

  <p class="c1"><span><br />
  Dan Connolly &#8207;@dckc<br />
  <br />
  finally! after 3 hours, got phpPgAdmin working. I want to like
  postgres over mysql, but the initial experience is
  dreadful.<br />
  0 retweets 0 favorites<br />
  12:42 AM - 4 Apr 2015<br />
  Tweet text<br />
  Reply to @dckc<br />
  <br />
  &#160; &#160;Robert Treat &#8207;@robtreat2 18h18 hours ago<br />
  <br />
  &#160; &#160;@dckc I (and some others in the community) would be
  interested in a more detailed writeup if you were willing.<br />
  &#160; &#160;0 retweets 1 favorite<br />
  <br /></span></p>

  <p class="c1"><span><br />
  Dan Connolly &#8207;@dckc<br />
  &lt;blockquote class="twitter-tweet"
  lang="en"&gt;&lt;p&gt;finally! after 3 hours, got phpPgAdmin
  working. I want to like postgres over mysql, but the initial
  experience is dreadful.&lt;/p&gt;&amp;mdash; Dan Connolly (@dckc)
  &lt;a
  href="https://twitter.com/dckc/status/584229649535737856"&gt;April
  4, 2015&lt;/a&gt;&lt;/blockquote&gt;</span></p>

  <p class="c1"><span>&lt;script async
  src="//platform.twitter.com/widgets.js"
  charset="utf-8"&gt;&lt;/script&gt;<br /></span></p>

  <p class="c1"><span>&lt;blockquote class="twitter-tweet"
  lang="en"&gt;&lt;p&gt;&lt;a
  href="https://twitter.com/dckc"&gt;@dckc&lt;/a&gt; I (and some
  others in the community) would be interested in a more detailed
  writeup if you were willing.&lt;/p&gt;&amp;mdash; Robert Treat
  (@robtreat2) &lt;a
  href="https://twitter.com/robtreat2/status/584523279056162816"&gt;April
  5, 2015&lt;/a&gt;&lt;/blockquote&gt;</span></p>

  <p class="c1"><span>&lt;script async
  src="//platform.twitter.com/widgets.js"
  charset="utf-8"&gt;&lt;/script&gt;</span></p>

  <p class="c0"></p>

  <p class="c1"><span>asdf</span></p>
</body>
</html>
